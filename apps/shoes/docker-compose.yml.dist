version: "3.1"

services:
  shoes_api:
    container_name: 'shoes-api-atlantica-conf-2023'
    build:
      context: .
      dockerfile: ./docker/shoes-api/Dockerfile
    environment:
      - PIPENV_PIPFILE=/app/apps/shoes/Pipfile
    volumes:
      - ./:/app/apps/shoes/
      - ../../shared/:/app/shared/
      - ../../shoes/:/app/shoes/
      - ../../tests/:/app/tests/
    ports:
      - "8000:8000"
    depends_on:
      - mysql
  mysql:
    image: mysql:8.0.33
    container_name: shoes-api-mysql-atlantica-conf-2023
    command: mysqld --sql_mode="NO_ENGINE_SUBSTITUTION"
    volumes:
      - mysql-data:/var/lib/mysql
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=shoes_api
      - MYSQL_USER=shoes_master
      - MYSQL_PASSWORD=can_do_all
    ports:
      - "3301:3306"
volumes:
  mysql-data: